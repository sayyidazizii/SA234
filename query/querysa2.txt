select 
	pm.MesinRowID, 
	hpwod.IDMaterial, 
	hpwo.ProsesID, 
	m.NmMesin, 
	pp.Nama,
	mt.KdMaterial, 
	mt.NmMaterial, 
	datepart(day, hpwo.tglproses) tgl, 
	hpwo.Shift, 
	hpwod.QtyTarget,
	SUM(hpwod.Qty) QtyOK, 
	SUM(hpwod.SPOk) QtySP
from hasilproseswo hpwo 
left join ISAPabrik.dbo.ProsesMesin pm on hpwo.RowID=pm.RefRowID
left join ISAPabrik.dbo.Mesin  m on m.RowID=pm.MesinRowID
join HasilProsesWODetail hpwod on hpwod.IDHPWO = hpwo.RowID
left join ISAPabrik.dbo.Material mt on mt.RowID = hpwod.IDMaterial
join ProsesProduksi pp on pp.RowID = hpwo.ProsesID
where hpwo.idliniproduksi = '6576C124-9EBC-4A49-902F-A0660499DFB9'
and hpwo.tglproses between '2022-06-01' and '2022-06-30'
group by pm.MesinRowID, hpwod.IDMaterial, hpwo.ProsesID, m.NmMesin, pp.Nama, mt.KdMaterial, mt.NmMaterial, hpwo.tglproses, hpwo.Shift,hpwod.QtyTarget
